Mind Map generated by NB MindMap plugin   
> __version__=`1.1`,showJumps=`true`
---

# ImmutatbleObject

## 目的

### 多线程并发修改一个对象，为了保持数据的一致性，需要根据对象状态进行加锁

#### 基于锁的等待

#### 线程上下文切换

### 不可变状态的对象就是，对象一旦创建，其对外可见的状态就保持不变

## 满足条件

### 类使用final修饰，防止子类改变行为

### 字段使用final修饰

#### JMM保证final修饰的字段在被其他线程可见时，它必定是初始化完成的

#### 初始化完成\-\-\-\> 对象的初始化方法执行完毕

### 对象创建过程中，this没有逃逸

### 任何字段，如果其引用其他状态可变的对象，如果需要返回这些值，应该进行防御性复制

## 场景

### 被建模对象状态变化不频繁

### 同时对一组数据（状态）进行写操作，整体需要保持原子性

### 使用某个对象作为安全的HashMap的Key

## 潜在问题

### 被建模的对象状态变更比较频繁

#### GC问题

### 防御性复制

## java类库

### String

### Integer

### CopyOnWriteArrayList
